<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cogito, ergo sum</title><link>https://winsphinx.github.io/blog/</link><description>Recent content on Cogito, ergo sum</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Thu, 22 Sep 2022 22:22:00 +0800</lastBuildDate><atom:link href="https://winsphinx.github.io/blog/index.xml" rel="self" type="application/rss+xml"/><item><title>使用 Python 操作 Excel 文件（又一篇）</title><link>https://winsphinx.github.io/blog/post/using-python-to-deal-excel-files-another/</link><pubDate>Thu, 22 Sep 2022 22:22:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/using-python-to-deal-excel-files-another/</guid><description>&lt;p>在&lt;a href="https://winsphinx.github.io/blog/post/using-python-to-deal-excel-files/">上一篇&lt;/a>中，使用了 xlrd、xlwt 两个库 的组合来操作 Excel 文件，但有几个缺点： &lt;!-- raw HTML omitted -->&lt;/p>
&lt;ul>
&lt;li>虽然 xlrd 可以读 xls 和 xlsx，但 xlwt 只能写 xls； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>xlwt 不能在原文件上修改，需要额外借助 xlutils。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;p>今天发现一个更好的库 &lt;code>xlwings&lt;/code>​，正好弥补了上述两个缺陷。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="安装">安装&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">pip install xlwings
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>xlwings 基本使用流程是先建立一个 app 实例，在 app 下建立 book（工作簿），在 book 下建立 sheet（工作表），在 sheet 下对 range（单元格范围）、chart（图表）、picture（图片）、api（格式）等对象进行操作。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="新建或打开工作表">新建或打开工作表&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">xlwings&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="nn">xw&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 1. 创建一个app应用，其中：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">app&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xw&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">App&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">visible&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">add_book&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># visible=True 表示打开操作Excel过程可见&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># add_book=False 表示启动app后不新建工作簿&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 2A. 新建一个工作簿&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wb&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">books&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 2B. 打开一个已经存在的工作簿&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wb&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">books&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;filename.xlsx&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 3A. 新建一个工作表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">wb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sheets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;sheet_name&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 3B. 打开一个已存在的工作表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">wb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sheets&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;sheet_name&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 也可以使用索引选择工作表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">wb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sheets&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 索引获取&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sheets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">count&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取当前工作表名字&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取单元格绝对路径&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B3&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_address&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 即 $B$3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B3&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">address&lt;/span> &lt;span class="c1"># 同上&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取指定工作表中数据的行数、列数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">used_range&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">last_cell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">row&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">used_range&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">last_cell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">column&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取指定范围中数据的行数、列数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A2:B2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">row&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A2:B2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">column&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 删除指定的工作表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sheets&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;sheet_name&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">delete&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="读取与修改单元格数据">读取与修改单元格数据&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## 读取&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 读取单元格&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="c1"># 也可使用 (行, 列) 格式定位，注意索引是以1开始&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 读取单元格范围&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B2:F2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 按列读取单元格范围&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B7:C10&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">options&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">transpose&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## 写入&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 写入单个数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 写入行&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 写入列&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B3&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">options&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">transpose&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;赵&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;钱&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;孙&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;李&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 写入块数据（可按行或按列）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B7&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;d&amp;#39;&lt;/span>&lt;span class="p">]]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B9&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">options&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">transpose&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;d&amp;#39;&lt;/span>&lt;span class="p">]]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 写入公式&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;F2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">formula&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;=sum(B2:E2)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## 删除&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 删除指定单元格数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B10&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">clear&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 删除指定范围内数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B7:B9&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">clear&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="格式调整">格式调整&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 合并单元格&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B3:C3&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">merge&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 解除合并单元格&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B3:C3&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">unmerge&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 设置行高、列宽&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">row_height&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">25&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">column_width&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 自动调试指定单元格高度和宽度&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">autofit&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 设置指定单元格背景颜色&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">93&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">199&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">221&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 字体名字&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Font&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;宋体&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 字体大小&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Font&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">28&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 字体颜色&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Font&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">255&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">124&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 是否加粗&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Font&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Bold&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 数字格式&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">NumberFormat&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;0.0&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 对齐方式&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">HorizontalAlignment&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">4108&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">VerticalAlignment&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">4130&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -4108 水平居中， -4131 靠左，-4152 靠右&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -4108 垂直居中（默认)，-4160 靠上，-4107 靠下，-4130 自动换行对齐&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 设置上边框线风格和粗细&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Borders&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">LineStyle&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1:B4&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Borders&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Weight&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Borders：1：左边线，2：右边线，3：上边线，4：下边线，5：左斜线，6：右斜线&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 7：外部左边线，8：外部上边线，9：外部下边线，10：外部右边线&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 11：内部竖线，12：内部横线&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># LineStyle：1：实线，2：虚线，3：波浪线，4：点画线，5：双点画线&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Weight：边框粗细&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="图表处理">图表处理&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 插入图片&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pictures&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;image_file_name&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 插入图表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cht&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">charts&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 加载数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">chart&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">set_source_data&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">expand&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 设置图表类型，可从xw.constants.chart_types获取全部图表类型&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chart_type&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;line&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 设置图表开始位置&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">top&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;D2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">top&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">left&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sht&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;D2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">left&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="保存退出">保存退出&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 保存新建的工作簿，并起一个名字（如果是对原文件做修改，直接save()即可）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">save&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;filename&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 关闭工作簿，关闭Excel文件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 销毁对象，退出Excel程序&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">quit&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>使用 Python 操作 Excel 文件</title><link>https://winsphinx.github.io/blog/post/using-python-to-deal-excel-files/</link><pubDate>Sun, 28 Aug 2022 13:46:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/using-python-to-deal-excel-files/</guid><description>&lt;p>使用 Python 来处理 Excel 文件中的数据，主要会用到 pandas。而处理 Excel 文件本身，则用到 xlrd 和 xlwt，以及 xlutils 这几个库。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="打开-excel-文件">打开 Excel 文件&lt;/h2>
&lt;p>用 xlrd 模块读取 Excel 文件，支持 xls 和 xlsx 格式。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">xlrd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取工作簿对象&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">book&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlrd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">open_workbook&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">formatting_info&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># xls格式&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">book&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlrd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">open_workbook&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">formatting_info&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># xlsx格式&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 使用子表索引创建工作表对象，可以用book.nsheets获取全部索引&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sheets&lt;/span>&lt;span class="p">()[&lt;/span>&lt;span class="n">sheet_index&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sheet_by_index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sheet_indx&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 使用子表名称创建工作表对象，可以用book.sheet_names()获取全部索引&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sheet_by_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sheet_name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 检查某个工作表是否导入完毕&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">boos&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sheet_loaded&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sheet_name&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">sheet_indx&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="行-列-单元格读取">行、列、单元格读取&lt;/h2>
&lt;p>读取的数据包括格式和数值两部分。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取工作表中的有效行数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nrows&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">nrows&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 返回由该行中所有的单元格对象，每个值内容为：单元类型:单元数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 单元类型：empty:0，string:1，number:2，date:3，boolean:4，error:5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rowx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">start_colx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end_colx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">row_slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rowx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">start_colx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end_colx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 返回由该行中所有单元格的数据类型&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">row_types&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rowx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">start_colx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end_colx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 返回由该行中所有单元格的数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">row_values&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rowx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">start_colx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end_colx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取工作表中的有效列数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ncols&lt;/span> &lt;span class="o">=&lt;/span>&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ncols&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 返回由该列中所有的单元格对象，每个值内容为：单元类型:单元数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">col&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">colx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">start_rowx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end_rowx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">col_slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">colx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">start_rowx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end_rowx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 返回由该列中所有单元格的数据类型&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">col_types&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">colx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">start_rowx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end_rowx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 返回由该列中所有单元格的数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">col_values&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">colx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">start_rowx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end_rowx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 返回单元格对象&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cell&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rowx&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">colx&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 返回单元格中的数据类型&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cell_type&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rowx&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">colx&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 返回单元格中的数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cell_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rowx&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">colx&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="新建工作簿">新建工作簿&lt;/h2>
&lt;p>使用 xlwt 新建一个空白 Excel，填写数据。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">xlwt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 创建一个工作簿并设置编码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">workbook&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Workbook&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">encoding&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;utf-8&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 添加工作表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worksheet&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">workbook&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_sheet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sheet_name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 按需设置行高列宽&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worksheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">height&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">H&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worksheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">col&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">width&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">W&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 写入对应的行, 列, 值&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worksheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 还可以填写公式，如：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worksheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Formula&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A1*B1&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worksheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Formula&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;SUM(A1,B1)&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worksheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Formula&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;HYPERLINK(&amp;#34;https://www.link&amp;#34;;&amp;#34;LINK_NAME&amp;#34;)&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 保存&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">workbook&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">save&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="在原工作簿修改">在原工作簿修改&lt;/h2>
&lt;p>如果在读取的 Excel 上做修改，则需要使用 xlutils 模块。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">xlutils.copy&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">copy&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 将xlrd对象拷贝转化为xlwt对象&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">new_book&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">copy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">book&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取转化后的工作表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">new_sheet&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">new_book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_sheet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 写入对应的行, 列, 值&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">new_sheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 保存&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">new_book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">save&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="格式处理">格式处理&lt;/h2>
&lt;p>写入数据的同时，对单元格格式做处理。包括字体、外观、颜色、边框、背景、对齐方式等（根据需要选用）。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 初始化样式&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">style&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">XFStyle&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 为样式创建字体&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">font&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Font&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 字体名称&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">font&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;Times New Roman&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 加粗&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">font&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bold&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 下划线&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">font&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">underline&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 斜体字&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">font&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">italic&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 字体颜色&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">font&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">colour_index&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">N&lt;/span> &lt;span class="c1"># 0~63&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 为样式创建边框&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">borders&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Borders&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 无:0，细实线:1，小粗实线:2，细虚线:3，中细虚线:4，大粗实线:5，双线:6，细点虚线:7&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 大粗虚线:8，细点划线:9，粗点划线:10，细双点划线:11，粗双点划线:12，斜点划线:13&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">borders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">left&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">borders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">right&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">borders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">top&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">borders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bottom&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">borders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">left_colour&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">borders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">right_colour&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">borders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">top_colour&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">borders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bottom_colour&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 为样式创建背景&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pattern&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Pattern&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 背景样式&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># NO_PATTERN, SOLID_PATTERN, 或从0x00 到 0x12&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pattern&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pattern&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Pattern&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SOLID_PATTERN&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 背景颜色&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pattern&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pattern_fore_colour&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">N&lt;/span> &lt;span class="c1"># 0~63&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 为样式创建背景&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">alignment&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Alignment&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 水平对齐方式：HORZ_GENERAL, HORZ_LEFT, HORZ_CENTER, HORZ_RIGHT, HORZ_FILLED, HORZ_JUSTIFIED, HORZ_CENTER_ACROSS_SEL, HORZ_DISTRIBUTED&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">alignment&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">horz&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Alignment&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">HORZ_CENTER&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 上下对齐方式：VERT_TOP, VERT_CENTER, VERT_BOTTOM, VERT_JUSTIFIED, VERT_DISTRIBUTED&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">alignment&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">vert&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xlwt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Alignment&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">VERT_CENTER&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 设定样式&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">style&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">font&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">font&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">style&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">borders&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">borders&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">style&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pattern&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pattern&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">style&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">alignment&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">alignment&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 带样式写入&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worksheet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">style&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>IPv6</title><link>https://winsphinx.github.io/blog/post/ipv6/</link><pubDate>Wed, 13 Jul 2022 18:33:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/ipv6/</guid><description>&lt;p>本文简单介绍 IPv6 的地址格式。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="8-段-128-位">8 段，128 位&lt;/h2>
&lt;p>IPv4 地址是类似 &lt;code>A.B.C.D&lt;/code> 的格式，它是 32 位，用“.”分成四段，用 10 进制表示。 &lt;!-- raw HTML omitted -->
而 IPv6 地址类似 &lt;code>XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX&lt;/code> 的格式，它是 128 位的，用“:”分成 8 段，每个 X 是一个 16 进制数（16 = 2^4）。可见，IPv6 地址空间相对于 IPv4 地址有了极大的扩充。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>IPv6 地址的长度为 128 位，由八个 16 位字段组成，相邻字段用冒号分隔。IPv6 地址中的每个字段都必须包含一个十六进制数字，而 IPv4 地址则以点分十进制表示法表示。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="3-个部分">3 个部分&lt;/h2>
&lt;p>IPv6 地址分三个部分： &lt;!-- raw HTML omitted -->&lt;/p>
&lt;ul>
&lt;li>站点前缀：最左侧的三个字段（48 位）包含站点前缀。站点前缀描述通常由 ISP 或区域 Internet 注册机构 (Regional Internet Registry, RIR) 分配的站点的公共拓扑； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>子网 ID：下一个字段是为站点分配的 16 位子网 ID。子网 ID 描述专用拓扑（也称为站点拓扑），因为它是站点的内部 ID； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>接口 ID：最右侧的四个字段（64 位）包含接口 ID，也称为标记。接口 ID 可以从接口的 MAC 地址自动配置，也可以采用 EUI-64 格式手动配置。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;p>以下列地址为例： &lt;em>2001:0db8:3c4d:0015:0000:0000:1a2f:1a2b&lt;/em> &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>此示例显示了 IPv6 地址的全部 128 位。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;ul>
&lt;li>前 48 位 2001:0db8:3c4d 包含表示公共拓扑的站点前缀； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>随后的 16 位 0015 包含代表站点专用拓扑的子网 ID； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>低阶（最右边的 64 位）0000:0000:1a2f:1a2b 包含接口 ID，可以用 mac 地址填充。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;h2 id="简化">简化&lt;/h2>
&lt;p>RFC2373 中详细定义了 IPv6 地址，按照定义，一个完整的 IPv6 地址的表示法： &lt;code>xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx&lt;/code> &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>例如： &lt;em>2031:0000:1F1F:0000:0000:0100:11A0:ADDF&lt;/em> &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>为了简化其表示法，RFC2373 提出每段中前面的 0 可以省略，连续的 0 可省略为“::”，但只能出现一次。例如： &lt;!-- raw HTML omitted -->&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>原地址&lt;/th>
&lt;th>简写&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>1080:0:0:0:8:800:200C:417A&lt;/td>
&lt;td>1080::8:800:200C:417A&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>FF01:0:0:0:0:0:0:101&lt;/td>
&lt;td>FF01::101&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>0:0:0:0:0:0:0:1&lt;/td>
&lt;td>::1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>0:0:0:0:0:0:0:0&lt;/td>
&lt;td>::&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>IPv6 中的前缀 &lt;!-- raw HTML omitted -->
类似于 IPv4 中的 CDIR 表示法，IPv6 用前缀来表示网络地址空间。比如： &lt;!-- raw HTML omitted -->
2001:250:6000::/48 表示前缀为 48 位的地址空间，其后的 80 位可分配给网络中的主机，共有 2 的 80 次方个地址 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="常见地址">常见地址&lt;/h2>
&lt;p>下面解释一些常见的 IPv6 地址或者前缀： &lt;!-- raw HTML omitted -->&lt;/p>
&lt;ul>
&lt;li>&lt;code>::/128&lt;/code> 即 0:0:0:0:0:0:0:0，只能作为尚未获得正式地址的主机的源地址，不能作为目的地址，不能分配给真实的网络接口； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;code>::1/128&lt;/code> 即 0:0:0:0:0:0:0:1，回环地址，相当于 ipv4 中的 localhost（127.0.0.1），ping locahost 可得到此地址； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;code>2001::/16&lt;/code> 全球可聚合地址，由 IANA 按地域和 ISP 进行分配，是最常用的 IPv6 地址； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;code>2002::/16&lt;/code> 6 to 4 地址，用于 6to4 自动构造隧道技术的地址； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;code>3ffe::/16&lt;/code> 早期开始的 IPv6 6bone 试验网地址；&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;code>fe80::/10&lt;/code> 本地链路地址，用于单一链路，适用于自动配置、邻机发现等，路由器不转发； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;code>ff00::/8&lt;/code> 组播地址； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;code>::A.B.C.D&lt;/code> 其中&amp;lt;A.B.C.D&amp;gt;代表 ipv4 地址，兼容 IPv4 的 IPv6 地址。自动将 IPv6 包以隧道方式在 IPv4 网络中传送的 IPv4/IPv6 节点将使用这些地址； &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;code>::FFFF:A.B.C.D&lt;/code> 其中&amp;lt;A.B.C.D&amp;gt;代表 ipv4 地址，例如 ::ffff:202.120.2.30 ，是 IPv4 映射过来的 IPv6 地址，它是在不支持 IPv6 的网上用于表示 IPv4 节点。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>上面三类属于单播地址，都是目前互联网上广泛应用的 IPv6 地址； &lt;!-- raw HTML omitted -->&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Happy Birthday</title><link>https://winsphinx.github.io/blog/post/happy-birthday/</link><pubDate>Mon, 27 Jun 2022 21:28:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/happy-birthday/</guid><description>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">\version &amp;#34;2.22.2&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">\header {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> title = &amp;#34;Happy Birthday&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tagline = ##f % disable default footer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">melody = {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \time 3/4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \tempo 4=110
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \key c \major
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \partial 4 g8 g
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c a&amp;gt;4 g c&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;g, b&amp;gt;2 g8 g
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> a4 g d&amp;#39; \break
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c c&amp;#39;&amp;gt;2 g8 g
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> g&amp;#39;4 e&amp;#39; c&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c b&amp;gt; a f&amp;#39;8 f&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c e&amp;#39;&amp;gt;4 c&amp;#39; d&amp;#39; \break
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c c&amp;#39;&amp;gt;2 g8 g
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c a&amp;gt;4 g c&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;g, b&amp;gt;2 g8 g
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> a4 g d&amp;#39; \break
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c c&amp;#39;&amp;gt;2 g8 g
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> g&amp;#39;4 e&amp;#39; c&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c b&amp;gt; a f&amp;#39;8 f&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c e&amp;#39;&amp;gt;4 c&amp;#39; d&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;c c&amp;#39;&amp;gt;2. \bar &amp;#34;|.&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">\score {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;&amp;lt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \new Staff {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \clef &amp;#34;treble_8&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \melody
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \new TabStaff {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \melody
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \layout { }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \midi { }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>
&lt;link rel="stylesheet" href="https://winsphinx.github.io/blog/css/hugo-easy-gallery.css" />
&lt;div class="box">
&lt;figure itemprop="associatedMedia"
itemscope itemtype="http://schema.org/ImageObject" >
&lt;div class="img">
&lt;img itemprop="thumbnail" src="https://winsphinx.github.io/blog/ox-hugo/birthday.png" />
&lt;/div>
&lt;a href="https://winsphinx.github.io/blog/ox-hugo/birthday.png" itemprop="contentUrl">&lt;/a>
&lt;/figure>
&lt;/div>
&lt;!-- raw HTML omitted -->&lt;/p></description></item><item><title>读时光之轮系列</title><link>https://winsphinx.github.io/blog/post/reading-wheel-of-time-series/</link><pubDate>Sat, 21 May 2022 20:45:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/reading-wheel-of-time-series/</guid><description>&lt;p>罗伯特·乔丹（Robert Jordan），美国小说家。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="书目">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 书目 &lt;!-- raw HTML omitted -->[0/15]&lt;!-- raw HTML omitted -->&lt;/h2>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 新春 &lt;em>New Spring&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>这个冬天比往年更加漫长。 &lt;!-- raw HTML omitted -->
撰史者吉塔拉的预言打破了白塔的宁静，那是关于真龙重生于龙山之上的末日预言。玉座塔摩拉随即派两仪师出塔，打探转生真龙的下落；暗地里，遣心腹部下至可疑地点搜寻。然而不久，玉座的心腹逐一遇害，塔摩拉也意外身亡。背后究竟是谁在策划阴谋？ &lt;!-- raw HTML omitted -->
刚晋升为两仪师的沐瑞与史汪无意间撞见预言的真相，并深陷白塔阴谋漩涡之中，她们能否平安逃脱？ &lt;!-- raw HTML omitted -->
经历了残酷的艾伊尔战争，马吉尔王子岚和同伴回到毗邻故国的北方，在前往查辛的路途中，岚与沐瑞狭路相逢。岚竭力挽救自己的国家，为死去的马吉尔人复仇。沐瑞打算凭一己之力找到转生真龙，挽救被暗影侵袭的世界。 &lt;!-- raw HTML omitted -->
对立的两人如何走向同盟？敌人还是朋友，真龙的下落如何？最后总有意想不到的结果。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 世界之眼 &lt;em>The Eye of the World&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>在时光之轮的世界里，时间是一个有着七根轮辐的轮子（一条大蛇首尾相衔环绕着一个七根轮辐的轮子）。每根轮辐是一个纪元。随着轮辐的转动，纪元也就随之更替。每一个纪元是很长的，所以虽然这个轮子只有七根轮辐，但当它转一周时，上一次的纪元往往早已被人遗忘。 &lt;!-- raw HTML omitted -->
太古，在阴影之战后，那些发疯的男性两仪师在临死之前彻底地改变了地球的面貌：山脉夷为平地，平地产生高山，旱地代替了海洋，海洋覆盖着旱地……过去的一切没有一丁点残留下来，幸存的人类挣扎着四处搜寻食物，只为多苟存一天。在数个纪元之后，不是学者，根本不可能知道关于阴影之战和裂世之战的点滴资料，而即使是学者，他们也只知道某些片断。 &lt;!-- raw HTML omitted -->
然而，尽管国家兴衰不定，几个世纪以来，走唱人却一直在传诵一个预言，那就是不会随时间而有一点变化的龙之预言。预言里说，龙将会重生，暗黑之主将会脱困而获得自由，真龙将会在末日之战中直面暗黑之主而拯救全人类——同时，他也将会再次摧毁这个世界。 &lt;!-- raw HTML omitted -->
被两仪师称为转生真龙的牧羊人兰德，在命运的中心徘徊，为了保护家乡与想保护的人，他与同为时轴的好友，一起踏上漫漫征途…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 大猎捕 &lt;em>The Great Hunt&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>几个世纪以来，走唱人一直在传诵关于失落的瓦力尔号角的传说，它可以让诸世代中死去的英雄重生。追寻圣号角的大猎捕召集令已发出，无论光明或暗影，都竭力想寻得这只号角。 &lt;!-- raw HTML omitted -->
而被两仪师称为转生真龙的牧羊人兰德，拥有导引男性至上力的能力，让他痛苦不已，惟有挺身面对一切，才能避免这世界为邪恶所操纵…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 转生真龙 &lt;em>The Dragon Reborn&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>弃光魔使们逃出封印藏身四处，黑宗两仪师现身白塔，究竟是谁？空前未有的暗影力量入侵各地，全力扭曲历史因缘。 &lt;!-- raw HTML omitted -->
假如所有的封印破碎，暗帝将重现世上，万物万灵皆倒伏于他所卷起的风暴中。仍旧站立的，只有那个为了对抗暗影而生的人——牧羊少年：芝德· 亚瑟，转生真龙。惟有真龙挥舞凯兰铎，远古的真龙之剑，才能击溃暗帝，让世界重生。 &lt;!-- raw HTML omitted -->
为了战斗下去，兰德必须找到凯兰铎；而为了阻止他，弃光魔使们将不惜摧毁这个世界…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 暗影渐起 &lt;em>The Shadow Rising&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>暗影的力量在急速扩张、增长，白塔突生惊天巨变，谁将血染塔瓦隆？ &lt;!-- raw HTML omitted -->
传说中不可攻陷的城堡——提尔之岩已经陷落，禁忌之剑落入了转生真龙——兰德·亚瑟手中，只有掌握阳极力，那将无数男人逼入疯狂的力量，他才有能力与暗帝对抗，拯救世界。 &lt;!-- raw HTML omitted -->
茫茫的艾伊尔荒漠隐藏着怎样的秘密？兰德•亚瑟能否在这里避开疯狂与死亡，寻找到属于自己的力量？ &lt;!-- raw HTML omitted -->
兽魔人突袭两河流域的故乡，回乡救援的佩林被因缘卷入抗争的漩涡。而在黑宗两仪师显身的坦其克，莫名的危险正在搅动梦幻和真实的世界…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 天空之火 &lt;em>The Fires of Heaven&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>转生真龙，随黎明而来之人，他的到来，是希望，也是毁灭。当弃光魔将成为唯一导师，兰德如何在暗影与光明中寻得出口…… &lt;!-- raw HTML omitted -->
囚禁至尊暗主的牢狱正缓慢地毁败。弃光魔将，暗影不朽的仆人们铺下重重陷阱，将人类的国度逐一控制在手中。他们已做好准备，等待著他们的主人重现世间。兰德．亚瑟，预言中的转生真龙，他知道自己必须打击敌人，但他的力量因背叛和野心而被分裂。 &lt;!-- raw HTML omitted -->
光明古老的守护者两仪师也在白塔的内战中分崩离析…… &lt;!-- raw HTML omitted -->
在被盟友背叛、敌人追杀，以及阳极力逼人疯狂的污染所困扰的情况下，兰德仍旧得向他的敌人全速赶去…… &lt;!-- raw HTML omitted -->
天空之火将洗净这个世界…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 混沌之王 &lt;em>Lord of Chaos&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>混沌之王暗帝之手冲破封印，邪恶泡沫满溢大地，四周敌友难以辨认，转生真龙在征服中迅速成长。 &lt;!-- raw HTML omitted -->
各有所图的盟军如何缔结？有阳极力的男人能否被挖掘和训练？沐瑞之后的两仪师可以信任吗？爱莉达之后的白塔有多少阴谋？情感的纠缠究竟是甜蜜还是负担？ &lt;!-- raw HTML omitted -->
光明与黑暗交织的混乱中，最后战争一触即发。为了将全世界统治在自己的意志之下，御万众者，混沌之王，注定经历这史无前例的血与火与灰的洗礼…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 剑之王冠 &lt;em>A Crown Swords&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>兰德·亚瑟成功逃离白塔的控制。甚至有一批两仪师低下了她们高昂的头，发誓如同殉道使一样，永远追随转生真龙的脚步。暗影奴仆与邪恶的泡沫却侵入一切。 &lt;!-- raw HTML omitted -->
在自以为高高在上的白塔，在力图夺回塔瓦隆的沙力达，在目空一切的圣光之子中，在严格奉行节义的艾伊尔中，欲望和野心成为暗帝操纵的把柄，权谋和流血刀刃般分裂人类的世界。 &lt;!-- raw HTML omitted -->
霄辰人从死亡岛上骑着飞鸟而来，弃光魔使在勾心斗角中布局势力，魔格丁逃离艾雯的掌控，古兰现身艾博达，这一次，兰德·亚瑟和他的伙伴们将如何转动时光之轮？ &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 匕首之路 &lt;em>The Path of Daggers&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>这是光与影对立的世界，善与恶进行着永无止尽的争战，这是时光之轮编织的世界。 &lt;!-- raw HTML omitted -->
兰德·阿瑟──转生真龙，已征服了伊利安，击败了弃光魔将沙马奥、阻止了霄辰的入侵。两仪师奈妮薇、艾玲达与伊兰也破坏了闇帝的企图，而流亡两仪师艾雯．艾威尔正率军前往白塔。 &lt;!-- raw HTML omitted -->
然而，兰德与跟随他的殉道使正逐渐地受到无极力的影响，如果他们无法去除闇帝对于无极真源的污染，他们将在面对闇影的最后战争中落败。当兰德挣扎于维持自身神智与力量之间，宵辰再次发动了袭击…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 寒冬之心 &lt;em>Winter&amp;rsquo;s Heart&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>兰德和明隐密地穿行于各国，凯苏安不动声色地跟随，菲儿和麦玎意外被俘，佩林失去理智…… &lt;!-- raw HTML omitted -->
霄辰人兵临艾博达，神秘的九月之女出现，在宫廷和预言之间，麦特如同困兽，伊兰重回安多，狮子王座如何夺回？在兰德的世界里，伊兰又是谁？ &lt;!-- raw HTML omitted -->
欲望和野心成为暗帝操纵的把柄，权谋和流血刀刃般分裂人类的世界，弃光魔使在勾心斗角中等待时机，这一次，兰德·亚瑟和他的伙伴们，将如何转动时光之轮？ &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 光影歧路 &lt;em>Crossroads of Twilight&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>光影歧路遍布荆棘，尽头发现宁静的芳草地，为救菲儿，佩林将愤怒铸成武器，马希玛虎视眈眈，暗之猎犬出没频频…… &lt;!-- raw HTML omitted -->
幽灵之城索哈勃带来新的转机，伊兰怀孕，凯姆林满城风雨，觊觎王座的敌人，在暗处强势聚集，兰德的安危，安多的责任，伊兰如何抉择？ &lt;!-- raw HTML omitted -->
麦特逃离了艾博达，却仍在图昂的十指山下，不再滥赌的少年，脑袋中总有骰子滚动，艾雯兵临塔瓦隆，与白塔是战是和？ &lt;!-- raw HTML omitted -->
在无穷尽的权利游戏中，谁是敌人，谁是朋友？爱情与阴谋，光明与黑暗，信任与怀疑……煞妖谷暗帝的封印即将被开启，暴风雨从世界之脊袭来，寒冬冰封大地。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 迷梦之刃 &lt;em>Knife of Dreams&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>末日战争的先兆逐一显现，转生真龙兰德·亚瑟注定要在这场战争中与暗帝正面交锋。他是人类唯一的希望，但在这场战争开始之前，他必须不计代价。 &lt;!-- raw HTML omitted -->
时间之风已经演变成一场风暴，所有人心目中确实无疑的事物正在他们眼前发生剧变，就连白塔也不再是一个安全之地。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 末日风暴 &lt;em>The Gathering Storm&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>最后风暴将凝聚起它的怒风，摧毁已经濒死的大地。 &lt;!-- raw HTML omitted -->
霄辰军队深夜来袭，爱莉达迎来她的末日她从噩梦惊醒，而现实比噩梦更残酷。 &lt;!-- raw HTML omitted -->
艾雯的孤军奋战，离胜利只有一步之遥，却被爱她的人们打乱阵脚，她有机会力挽狂澜吗？麦特的历险仍在继续，辛德泰普的诅咒会是什么？ &lt;!-- raw HTML omitted -->
珂丹卡爆炸了，至上力瞬间熄灭。兰德第一次从心里睁开眼睛，他明白，再也不会听到路斯·瑟林的声音。 &lt;!-- raw HTML omitted -->
暗影笼罩的世界，龙山之巅犬牙交错，却有阳光散落时光之轮，将兰德一次次带回世间。而这一次，他只想要做对一件事…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 午夜高塔 &lt;em>The Tower of Midnight&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>梦之世界出现神秘的杀戮者，佩林在丧友之痛中完成蜕变，用至上力铸造出王的武器——玛哈雷尼。古语译为“它在飞翔”。 &lt;!-- raw HTML omitted -->
麦特去根结之塔营救沐瑞，前提是他必须破解蛇与狐狸的无解之谜。这里麦特说出全书最霸气的一句话：“他们在玩一个游戏，只要是游戏，我就能赢。”然而麦特也为此付出了沉重的代价。 &lt;!-- raw HTML omitted -->
在鲁迪恩，艾玲达预见了整个艾伊尔种族终将覆亡的命运。全世界只她一人知道艾伊尔的可怕未来，那么她作为智者，如何拯救她的族人？ &lt;!-- raw HTML omitted -->
兰德誓要打破暗帝牢狱残存的封印，他为何要将这一企图第一时间告诉白塔玉座艾雯？在真龙与玉座之间，又会掀起怎样的波澜？ &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 光明回忆 &lt;em>A Memory of Light&lt;/em> &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>末日之战终于全面爆发，兰德与暗帝在煞妖谷的对决，麦特与狄芒德在梅丽罗平原的对决，佩林与杀戮者在梦之世界的对决…… &lt;!-- raw HTML omitted -->
三位主人公，不同层次的较量，为我们呈现出全方位的史实和幻梦般的景象。人物命运以及种族命运设定的悬念草灰蛇线伏线千里。主人公兰德最后关头的逆转令人拍案叫绝。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote></description></item><item><title>善</title><link>https://winsphinx.github.io/blog/post/good-or-evil/</link><pubDate>Tue, 05 Apr 2022 16:30:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/good-or-evil/</guid><description>&lt;p>关于善的一些思考。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="善念">善念&lt;/h2>
&lt;p>每一个坏人大概也都干过几件好事，或许是成本不高随手做了，或许是为了获取一些优越感、救赎感，又或许就单纯是内心善良的一小部分突然被激活了。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>而每一个善良的人大概也有过无数次做恶的冲动。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>每个人都有行善和作恶的本能，想行善时行善自然很好，但更重要的是，想做恶时，能察觉并控制内心的贪婪、愚蠢、愤怒，这真的很难。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>真正的善良不是你哪一天哪一次做了些什么，而是永远保持警惕，与自己“恶”的一面旷日持久的对抗。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>真正的善良是不作恶。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="善行">善行&lt;/h2>
&lt;p>真正的善良是一种以对其他人或物的真正共情（又叫同理心）为基础，以它自身为目的的意志。它应该同时满足以下几点： &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>一、不是外部道德灌输的结果。否则就像是给机器人输入善的程序，然后机器人依照程序做出善的行为一样，它并不真的理解这种善，实质上还是无善无恶的。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>二、不是为了得到好处或避免惩罚。这里说的好处和惩罚除了有形的外，还包括社会名声的损益等各种无形的。但是要举出完全避免“得到好处”的嫌疑的例子很难，因为哪怕是实现了自己的道德满足感，也是一种好处。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>三、以有自由选择的能力为前提。具体地说是，当一个人既可以选择善良的 A 行为，又可以选择不善良的 B 行为时，他选择了 A 行为，我们才能说这是真正的善良；反之，如果这个人只有 A 行为一个选择，就不能说是真正的善良。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>四、以对信息有足够的掌握为前提。如果仅仅因为无知而善良，那么这其实类似于被欺瞒情况下的选择，不能算是真正的选择。见识过黑暗，了解过残酷，而仍旧善良，才是真正的善良。 &lt;!-- raw HTML omitted -->&lt;/p></description></item><item><title>读光晕系列</title><link>https://winsphinx.github.io/blog/post/reading-halo-series/</link><pubDate>Sun, 27 Mar 2022 20:36:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/reading-halo-series/</guid><description>&lt;p>埃里克·尼伦德（Eric Nylund），美国小说家。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="书目">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 书目 &lt;!-- raw HTML omitted -->[0/7]&lt;!-- raw HTML omitted -->&lt;/h2>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 致远星的沦陷 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>人类进入宇宙殖民时代后，与强大而好战的圣约人遭遇，圣约人宣称人类亵渎了他们的信仰，对人类发动了全面战争。很早以前，人类就在进行一个绝密军事计划——斯巴达 II。该计划培育了数十名基因强化战士，这些超级生化士兵装备着配有人工智能的能量盔甲，战斗力之强超出想像。战争爆发后，以约翰为首的超级战士们被投入战场，果然所向披靡。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 洪魔 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>在与圣约人的战争中逃出来秋之柱号巡洋舰降落到了神秘的巨大环状天体“光晕”上。圣约人的追兵紧跟着奔袭而来，俘获了秋之柱号巡洋舰的舰长。秋之柱号巡洋舰上惟一的一名超级生化战士约翰-117，在 105 空降师的伞兵们协助下，左冲右突，四处游击，伺机从圣约人手中救回舰长。双方杀得难解难分，却全然不知可称为生命公敌的梦魇——洪魔，同样沉睡在这个不祥世界中。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 初次反击 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>摧毁光晕后，从光晕上成功出逃的约翰-117 尽力收拢被打散的人类残余部队，力图回到地球。而致远星也并未被圣约人彻底摧毁，约翰-117 的部下大多还活着。这是因为致远星上有着圣约人渴望得到的光晕建造者所留下的&amp;quot;圣物&amp;quot;。约翰-117 超人一般永不停息地战斗着，居然成功抢夺了一艘敌舰杀回致远星，救下了自己那些已夺得&amp;quot;圣物&amp;quot;的部下。然而在逃回地球的过程中，他们发现圣约人竟集结了约五百艘战舰的庞大舰队，意欲进攻地球！地球的命运已经危如累卵… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 奥星的幽灵 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>在士官长奋力反击星盟势力、保卫地球的同时，军情局“情报三处”精心设计了一个计划来为 UNSC 争取更多时间。奥尼克斯星表面上荒无人烟，是展开新行动的绝佳场所。但士官长摧毁第一个光晕之后，也触发了奥尼克斯星上深藏的上古先贤的科技。UNSC 的人类舰队与星盟的舰队又再次展开了事关扭转战局的生死较量。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 丰饶星战役 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>人类足迹已经遍及整个银河系，丰饶星是系外殖民地中最遥远的一个。尽管丰饶星的大小仅为地球的三分之一，但这里的土地却非常肥沃，为其它殖民地提供粮食补给 UNSC 海军情报部（奥尼，ONI）注意到丰饶星空域人类船只的神秘失踪事件，并怀疑是叛军所为。海军情报部从前线调回约翰逊上士和伯恩上士率领民兵部队前往保护丰饶星。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 柯尔协议 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>在科尔上将率领三倍数量于敌方的 UNSC 舰队，经过长达六年的战争之后，终于在 2531 年以损失三分之二战舰的代价、最后一刻战术上的灵光闪现取得了胜利。丰饶星战役后的短短四年，尽管科尔上将有出色的领导能力和战略才华，星盟凭借科技上的优势保证了他们在大多数战役中取得四比一的杀伤率，科尔的舰队损失惨重。到了 2535 年，几乎所有远地殖民地都已经被星盟攻陷。为了保护人类的母星，科尔上将建立了著名的科尔协议，规定所有 UNSC 舰船都不能暴露人类殖民地的位置，不惜一切代价。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 柯尔将军的传奇一生与最后一役 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote></description></item><item><title>二话</title><link>https://winsphinx.github.io/blog/post/two/</link><pubDate>Tue, 22 Feb 2022 22:22:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/two/</guid><description>&lt;p>今天是 2022 年 2 月 22 日，农历正月二十二，又适逢星期二。在这样一个很“二”的日子里，作为一个很“二”的人，便有了一些很“二”的话。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;ul>
&lt;li>关于战争 &lt;!-- raw HTML omitted -->
&lt;ul>
&lt;li>敌人的敌人，不见得是朋友。兔子、老鹰、毛熊，三者之间，没有友谊。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>一边是“友谊”，一边是“正义”。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>站在左边被右边打，站在右边被左边打，站在中间被两边打。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>关于疫情 &lt;!-- raw HTML omitted -->
&lt;ul>
&lt;li>三年前大家防的是新冠病毒，现如今大家防的是新冠病人。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>三年前还没有疫苗凭绿码出行，现如今基本都打了疫苗还凭绿码 + 行程码 + 核酸检测报告，出门如同出国。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>三年前有个同学自己第一个做作业，现如今其他同学都开始交作业了，这个同学还在做作业。真不愧是卷国人。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>国外是既停止集中娱乐，也停止集中办公，国内是只停止集中娱乐，不停止集中办公，这一定是由于国外疫情比国内严重的缘故。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>禁止聚集，然后聚集做核酸。可能是只要到了核酸采集点，就会处于百毒不侵的状态。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>三年过去了，特效药没发明，却发明了一大堆名词：无症状感染者、时空伴随、精准防控、社区基本面清零、……只要词语用得好，没有困难打不倒。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>“青春才几年，疫情占三年。”对于这些上网课大学生而言，今后填学历，该写“全日制”呢，还是“函授”？ &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;em>Be positive. Be patient.&lt;/em> 翻译成“成为阳性，成为病人”，应该没问题吧？ &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>今日封五城，明日封十城，然后得一夕安寝。起视四境，而新冠又至。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>凡染新冠者，虽远必诛。新冠患者，是病人呢，还是犯人？ &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>得了新冠，按照目前的医疗水平，不见得会病死，但按照目前的防疫措施，一定会社死。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>要不惜一起代价保护人民，即使这代价是人民。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>关于工作 &lt;!-- raw HTML omitted -->
&lt;ul>
&lt;li>只要你努力工作，办事靠谱，从来不向领导提要求，不给领导添麻烦，时间久了你会发现，你得到的不是领导的信任和肯定，而是一堆烂事和杂事。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>只要你乐于助人，团结同事，面对别人的请求，每次都热心给予帮助，时间久了你会发现，你得到的不是同事的友好和支持，而是越来越多的请求。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>只要你有责任有担当，敢于在工作出现问题的时候站出来，时间久了你会发现，你得到的不是领导的赞许和同事们的敬佩，而是别人无情甩过来的锅。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>延迟退休，不是由于劳动力不足了，而是因为养老金不够了。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>一边是 996 愈演愈烈，一边是失业者……不，应该叫“灵活就业者”越来越多。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>小作文</title><link>https://winsphinx.github.io/blog/post/articles/</link><pubDate>Wed, 05 Jan 2022 19:16:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/articles/</guid><description>&lt;p>孩子参加一个科幻作文比赛，主题是关于未来的食物。为人父母，不甘落后，各自凑了个数，汇成三篇小作文。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="一">一&lt;/h2>
&lt;blockquote>
&lt;p>热闹的饭馆遍布了整个街道，熙熙攘攘的人群鱼贯而入。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>艾伦看着人群，寻找着哪家餐馆最受欢迎。他走进了一家有七层楼高的黑色餐厅，上面写着“最好的餐馆”。走进餐厅，食物的香味扑面而来。艾伦一进门就受到服务员的热烈欢迎。“先生，您去几楼？”艾伦怔住了，有些不理解，他本是一个出生在乡村的少年，刚来这座繁华城市打工。服务员笑着对他说：“一楼是昆虫食物，里面有蚯蚓、蚂蚁、蜘蛛等一系列富含高蛋白质的食物，也是我们餐厅最受欢迎的楼层。”艾伦跟着服务员进入了一楼餐厅。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>进入里面，竟如家乡足球场大小一般，老老少少男男女女都有。抬头望见一张张食物图片，艾伦排起了长队，近三个小时过去了，终于轮到艾伦了。“你好，我想点珊瑚汽水、蚂蚁干和蚯蚓饼。”服务员娴熟地拿出了食品并进行了包装，一共十七元钱，艾伦扫脸进行了支付，全程也就几秒钟。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>坐在餐桌旁，热闹的话语充斥在耳边。邻近的一桌是一家人，只听见老奶奶问她儿子：这真的能吃吗？蚂蚁不是昆虫吗？一旁的孩子一遍遍解释，最终老奶奶被说服了，吃了几口之后就不停地吃着，嘴上还说这很好吃。艾伦想起小时候，自己在农村地里玩耍，他在泥土里抓蚯蚓，旁边围着一群小伙伴，当他抓起蚯蚓，拿到他们面前，他们立刻逃开，久而久之，他们渐渐不与艾伦玩了。当蚯蚓饼入嘴，艾伦彷佛看见小时候的画面出现，这真不一样呀。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>艾伦感到有些饱了，拿起珊瑚汽水倒进嘴巴，入嘴的汁水如甘露般清凉，但并不冷。艾伦在城里做工时的疲劳瞬间消失，他嗅了嗅，一股清香扑鼻而来，红黄色汁水入喉，喉咙的干涩缓解。艾伦不禁问旁边的人，一位大叔说道：“这是来自寒暖流交汇的天平洋斐济岛的特产，人工从几千米深处捕捞，一次次提炼才有现在的汁水，能让人缓解疲劳，延年益寿。”说完，大叔还推荐了蜘蛛肉，富含蛋白质，最适合你们这些小伙子了。艾伦谢过老人。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>艾伦吃完，仍不尽兴，又来到一家餐馆，这家餐馆并没有很多人。艾伦马上买好了食物，是蟑螂蛋白块和海洋上的海藻汤，艾伦品尝了起来。确实好吃，且新奇。早些年，乡村闭塞，都是些平常菜肴，吃了十几年，从没吃过像今天这样的食物。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>艾伦又走到街口，准备往回走，一个路摊上的老妇人叫住了他。艾伦看见一包包又一包包的食物，上面写着真菌食物。艾伦好奇地买了几包。在路上，艾伦品尝起来，真是美妙。艾伦真不后悔来到这座城市最繁华的街道上吃最独特的食物。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>艾伦虽然逛出了这街道，但仍觉不满足，又拐了回去。差不多该吃晚饭了，艾伦想到，路边一家名叫“营养肉馆”的店把他吸引住了。艾伦走进一看，上面写着红细胞、白细胞、干细胞……总共有 20 种，艾伦买了 4 种，拿回到餐桌上吃，一边吃一边与餐桌上的人闲谈。他们毫不保留地分享着他们饮食的一切，当问到这些白细胞食物时，他们说道，这些都是由实验室培育的人体细胞所合成的，不仅能减少传统养殖的污染，又能改变我们的饮食习惯。其中，一对老年夫妇补充道：“三四十年前，我们一直都吃自己种的蔬菜和一些普通食物，哪有现在那么多，起初我们不适应，觉得这些食物不好，但当我们去试吃后，竟有些依赖于它们了。现在，我们孩子也做了食物的工作，一个女儿去了食品研究院，研究人类未来的食品，一个儿子去了农场，培育新品种食物……” &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>艾伦离开了饭桌，来到门外，举目望向西边天际，那是家乡的方向，那里有十几年生活着的时光，又转身回望刚才经过的一家家饭店，那些刷新他认知的食物在脑海中浮现。嘴中的蚯蚓干正咀嚼着，那味道让他忘却了一切忧愁，真菌食物让他精神焕发，想起了故乡，想起了过去，想起了生活，思绪在脑中飘荡…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>太阳渐渐落山了，东方展现出奇特的颜色，眺望着那满目的紫红色，艾伦不禁陶醉其中。像一张布拉开了他的新生活，又像一座桥让他走进这都市，更像一面墙，写着人类灿烂的创造。艾伦坚定了信念，向城市深处走去…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;h2 id="二">二&lt;/h2>
&lt;blockquote>
&lt;p>刚刚上完满满一天的课，艾伦又累又饿，来到学校食堂。学校食堂的菜一直是他的最爱，排在长长的队伍里，闻着菜香，彷佛间，艾伦进入了一个明亮清新的餐厅…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>“同学，你好，我是希希，欢迎你来到新星食堂，今天是 2122 年 1 月 1 日，这里有营养餐、订制餐、饮料区、医疗餐、特色餐等五个餐区，请问您先去哪边？”门口一个可爱的导购机器人向我招手，一边致词，一边他背上的显示屏上显示出五个颜色的餐区。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>艾伦太饿了，就先选了红色的营养餐区。导购希希带我来到该餐区，显示屏上立刻显示出三个选项：文科、理科、文科+理科。他感觉好新奇，是不是吃了相应的套餐，学习成绩就会提高呢？机器人好像知道我的疑问似的，自动解释说：“三个选项均为 2 荤 1 素，内有 10 个不同的套餐，你可以根据自己的喜好随意选择，文科套餐以增强记忆力的食物为主，理科套餐以益智的深海鱼虾类等食物为主，文理套餐则是综合性的五谷杂粮类为主。”今天下午刚上了物理课和化学课，艾伦感觉有些难度，立刻就点了一份理科套餐。等了 2 分钟，餐区里又出来了一个送餐机器人，把一个写着理科的绿色餐盒递给他。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>接着，艾伦又跟着希希来到了第二个订制餐区，希希介绍说：“这是为特殊需要的学生准备的，如果营养餐没有你想要吃的或者你想额外添加，你可以根据我们提供的食材自己搭配，我们会立马加工，稍后给你送过来。” &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>艾伦看了一下食谱，点了一份他喜欢吃的鸡米花，显示屏显示需要 5 分钟。这时，希希说带艾伦去饮料区看看。饮料菜单里有好多他从没有见过的品种，希希继续说：“今天的特价款是珊瑚汽水，这是来自寒暖流交汇的天平洋斐济岛的特产，人工从几千米深处捕捞，一次次提炼才有现在的汁水，能让人缓解疲劳，延年益寿。”想到能缓解疲劳，艾伦毫不犹豫地点了一瓶。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>随后，他们来到医疗餐区。这里展示着不同颜色的糖果，外面屏幕上显示着不同的功能：明目、增高、减肥、美容、黑发、开胃等。艾伦摸了摸自己厚厚的镜片，立马挑选了明目糖果。最后，艾伦进入了特色餐区，五花八门的点心映入眼帘，这是他以前从来没有见过，例如蚯蚓饼、蚂蚁干、蜘蛛肉，蟑螂蛋白块、海藻汤，还有真菌食物（如红细胞、白细胞、干细胞）等 20 余种，看得他眼花缭乱。正在艾伦犹豫时，希希解释道：“这里有来自各地的特色点心，柬埔寨的蜘蛛肉富含蛋白质，最适合你们这些男生了。这些来自美国的白细胞食物都是由实验室培育的人体细胞所合成的，不仅能减少传统养殖的污染，又能改变我们的饮食习惯。” 艾伦听从了希希的建议，点了一份蜘蛛肉和白细胞食物。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>这时，艾伦点的鸡米花由订制餐区服务机器人送过来了。这里的服务也太棒了，他选了一个靠窗的位置，吃起了理科套餐，果然是益智的好帮手，不仅美味，而且让他感觉精神焕发。配上新点的蜘蛛肉和白细胞食物，黑白两色，黑色的蜘蛛肉酥脆美味，白色的细胞食物像果冻似的，鲜美极了。伴着珊瑚汽水，入嘴的黄色汁水清香扑鼻如甘露般清凉，但并不冷，喉咙的干涩瞬间缓解。最后，艾伦咀嚼起明目糖果，酸酸甜甜的，好吃极了。吃完如此营养美味的晚餐，他满足的抬头环视，竟一眼就认出一旁正津津有味吃着的文科套餐，正是他的同桌憨憨，他向我微笑…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>“艾伦，轮到你了，赶紧点菜啊！”这时，艾伦感觉旁边有人叫他的名字，抬头一看，正是憨憨，哦，原来刚才是梦境呢。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>艾伦坐在餐桌上，吃着刚点的菜，想着刚才的梦境，多希望自己将来有机会也能从事和食物有关的工作，譬如去食品研究院，研究人类未来的食品，或去农场，培育新品种食物。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>晚餐后，艾伦走出食堂，举目远方。太阳渐渐退去，东方展现出奇特的颜色，眺望着那满目的紫红色，令人不禁陶醉其中。未来的美食之梦萦绕在艾伦脑海中，他坚定了信念，向教室走去…… &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;h2 id="三">三&lt;/h2>
&lt;blockquote>
&lt;!-- raw HTML omitted -->
&lt;/blockquote></description></item><item><title>读数学女孩系列</title><link>https://winsphinx.github.io/blog/post/reading-math-girls-series/</link><pubDate>Sat, 25 Dec 2021 14:36:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/reading-math-girls-series/</guid><description>&lt;p>结城浩（結城 浩，ゆうき ひろし），日本技术作家。&lt;/p>
&lt;h2 id="数学女孩">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 数学女孩&lt;/h2>
&lt;h2 id="费马大定理">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 费马大定理&lt;/h2>
&lt;h2 id="哥德尔不完备定理">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 哥德尔不完备定理&lt;/h2>
&lt;h2 id="随机算法">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 随机算法&lt;/h2>
&lt;h2 id="伽罗瓦理论">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 伽罗瓦理论&lt;/h2></description></item><item><title>读太空漫游系列</title><link>https://winsphinx.github.io/blog/post/reading-arthur-charles-clarke-series/</link><pubDate>Mon, 29 Nov 2021 18:22:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/reading-arthur-charles-clarke-series/</guid><description>&lt;p>亚瑟·查尔斯·克拉克（Arthur Charles Clarke），英国作家。&lt;/p>
&lt;h2 id="系列">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 系列&lt;/h2>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> 2001 太空漫游&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> 2010 太空漫游&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> 2061 太空漫游&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> 3001 太空漫游&lt;/li>
&lt;/ul></description></item><item><title>Learning Hy</title><link>https://winsphinx.github.io/blog/post/learning-hy/</link><pubDate>Sat, 23 Oct 2021 18:57:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/learning-hy/</guid><description>&lt;p>Hy is a lisp dialect built on top of python. This is achieved by converting hy code to python’s abstract syntax tree (ast). This allows hy to call native python code or python to call native hy code as well.&lt;/p>
&lt;h2 id="基础">基础&lt;/h2>
&lt;p>以下为 Hy 以及对应的 Python 代码：&lt;/p>
&lt;h3 id="s-表达式">S-表达式&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-hy" data-lang="hy">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">function&lt;/span> &lt;span class="nv">args&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; function(args)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">+&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 4 + 1 + 2 + 3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">*&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">**&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 2 * (3 ** 2)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">not&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">=&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; not (5 == 4)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="变量">变量&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-hy" data-lang="hy">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">setv &lt;/span>&lt;span class="nv">x&lt;/span> &lt;span class="mi">42&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; x = 42&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="函数">函数&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-hy" data-lang="hy">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">defn &lt;/span>&lt;span class="nv">name&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nv">args&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;doc-string&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">body&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; def name(args):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; &amp;#34;&amp;#34;&amp;#34;doc-string&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; body&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 可选参数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">defn &lt;/span>&lt;span class="nv">ab&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nv">a&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nv">optional&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">b&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">]]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nv">a&lt;/span> &lt;span class="nv">b&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; def ab(a, b=2):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; return [a b]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 可变参数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">defn &lt;/span>&lt;span class="nv">something-fancy&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nv">something&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">rest &lt;/span>&lt;span class="nv">descriptions&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nv">kwargs&lt;/span> &lt;span class="nv">props&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">print&lt;/span> &lt;span class="nv">something&lt;/span> &lt;span class="nv">descriptions&lt;/span> &lt;span class="nv">props&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; def something-fancy(something, *descriptions, **props):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; print(something, *descriptions, **props)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 匿名函数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nb">map&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">fn &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">x&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">*&lt;/span> &lt;span class="nv">x&lt;/span> &lt;span class="nv">x&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="c1">;=&amp;gt; [1 4 9 16]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; (map lambda x: x * x, [1, 2, 3, 4])&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="序列">序列&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-hy" data-lang="hy">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 元组&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">setv &lt;/span>&lt;span class="nv">mytuple&lt;/span> &lt;span class="p">(&lt;/span>, &lt;span class="mi">1&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; mytuple = (1, 2)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 列表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">setv &lt;/span>&lt;span class="nv">mylist&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; mylist = [1, 2, 3, 4]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">get &lt;/span>&lt;span class="nv">mylist&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; mylist[1]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">cut&lt;/span> &lt;span class="nv">mylist&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; mylist[1:3]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">assoc &lt;/span>&lt;span class="nv">mlist&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; mylist[2] = 10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 字典&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">setv &lt;/span>&lt;span class="nv">mydict&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;key1&amp;#34;&lt;/span> &lt;span class="mi">42&lt;/span> &lt;span class="s">&amp;#34;key2&amp;#34;&lt;/span> &lt;span class="mi">250&lt;/span>&lt;span class="p">})&lt;/span> &lt;span class="nv">or&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">setv &lt;/span>&lt;span class="nv">mydict&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="ss">:key1&lt;/span> &lt;span class="mi">42&lt;/span> &lt;span class="ss">:key2&lt;/span> &lt;span class="mi">250&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; mydict = {&amp;#34;key1&amp;#34;: 42, &amp;#34;key2&amp;#34;:250}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">get &lt;/span>&lt;span class="nv">mydict&lt;/span> &lt;span class="s">&amp;#34;key1&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nv">or&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="ss">:key1&lt;/span> &lt;span class="nv">mydict&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; mydict[&amp;#34;key1&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">assoc &lt;/span>&lt;span class="nv">mydict&lt;/span> &lt;span class="s">&amp;#34;key3&amp;#34;&lt;/span> &lt;span class="mi">996&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; mydict[&amp;#34;key3&amp;#34;] = 996&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="python-互操作">Python 互操作&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-hy" data-lang="hy">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">import &lt;/span>&lt;span class="nv">datetime&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; import datetime&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">import &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">functools&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nv">partial&lt;/span> &lt;span class="nb">reduce&lt;/span>&lt;span class="p">]])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; from functools import partial, reduce&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">import &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">matplotlib.pyplot&lt;/span> &lt;span class="ss">:as&lt;/span> &lt;span class="nv">plt&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; import matplotlib.pyplot as plt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">.split&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">.strip&lt;/span> &lt;span class="s">&amp;#34;Hello World &amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; &amp;#34;Hello World &amp;#34;.strip().split()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 可以采用穿线宏表达法，更加接近于链式调用的写法&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">-&amp;gt; &lt;/span>&lt;span class="s">&amp;#34;Hello World &amp;#34;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">.strip&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">.split&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 穿线宏有头部穿线……&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">-&amp;gt; &lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">-&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">;=&amp;gt; 3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 相当于&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">+&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">-&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; ……以及尾部穿线&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">-&amp;gt;&amp;gt; &lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">-&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">;=&amp;gt; -1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 相当于&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">+&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">-&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="结构控制">结构控制&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-hy" data-lang="hy">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 单一条件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">condition&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nv">true-body&lt;/span> &lt;span class="nv">false-body&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; if condition:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; true-body&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; else:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; false-body&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 多条件入口&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">cond&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[(&lt;/span>&lt;span class="nf">=&lt;/span> &lt;span class="nv">val&lt;/span> &lt;span class="mi">42&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">print&lt;/span> &lt;span class="s">&amp;#34;Same&amp;#34;&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[(&lt;/span>&lt;span class="nf">&amp;lt;&lt;/span> &lt;span class="nv">val&lt;/span> &lt;span class="mi">42&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">print&lt;/span> &lt;span class="s">&amp;#34;Less&amp;#34;&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[(&lt;/span>&lt;span class="nf">&amp;gt;&lt;/span> &lt;span class="nv">val&lt;/span> &lt;span class="mi">42&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">print&lt;/span> &lt;span class="s">&amp;#34;More&amp;#34;&lt;/span>&lt;span class="p">)])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; if val == 42:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; print(&amp;#34;Same&amp;#34;)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; elif val &amp;lt; 42:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; print(&amp;#34;Less&amp;#34;)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; elif val &amp;gt; 42:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; print(&amp;#34;More&amp;#34;)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; 多语句使用do组成块&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nf">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nf">body-1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nf">body-2&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="类">类&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-hy" data-lang="hy">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">defclass &lt;/span>&lt;span class="nv">Wizard&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nb">object&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="kd">defn &lt;/span>&lt;span class="nv">--init--&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="bp">self&lt;/span> &lt;span class="nv">spell&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="kd">setv &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="nv">.spell&lt;/span> &lt;span class="nv">spell&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="kd">defn &lt;/span>&lt;span class="nv">get-spell&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="nv">.spell&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; defclass Wizard(object):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; def __init__(self, spell):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; self.spell = spell&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; def get_spell(self):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; return self.spell&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="练手">练手&lt;/h2>
&lt;p>学以致用，随手写了一个抓取必应壁纸的小程序——&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-hy" data-lang="hy">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">import &lt;/span>&lt;span class="nv">os&lt;/span> &lt;span class="nv">re&lt;/span> &lt;span class="nv">requests&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">setv &lt;/span>&lt;span class="nv">URL&lt;/span> &lt;span class="s">&amp;#34;https://www.bing.com/&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">setv &lt;/span>&lt;span class="nv">NAME&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">-&amp;gt; &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">re.compile&lt;/span> &lt;span class="s">&amp;#34;url\(/th\?id=(.*?\.jpg).*\)&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">.search&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">-&amp;gt; &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">requests.get&lt;/span> &lt;span class="nv">URL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">.&lt;/span> &lt;span class="nv">text&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">.group&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="kd">setv &lt;/span>&lt;span class="nv">ADDRESS&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">+&lt;/span> &lt;span class="nv">URL&lt;/span> &lt;span class="s">&amp;#34;th?id=&amp;#34;&lt;/span> &lt;span class="nv">NAME&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">with&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nv">FILE&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">open&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">os.path.join&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">os.getcwd&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="s">&amp;#34;wallpapers&amp;#34;&lt;/span> &lt;span class="nv">NAME&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="s">&amp;#34;wb&amp;#34;&lt;/span>&lt;span class="p">)]&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">.write&lt;/span> &lt;span class="nv">FILE&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">-&amp;gt; &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">requests.get&lt;/span> &lt;span class="nv">ADDRESS&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">.&lt;/span> &lt;span class="nv">content&lt;/span>&lt;span class="p">))))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Spacemace Keys</title><link>https://winsphinx.github.io/blog/post/spacemace-keys/</link><pubDate>Thu, 23 Sep 2021 19:10:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/spacemace-keys/</guid><description>&lt;p>整理了 Spacemacs 的一些常用键。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="git">git&lt;/h2>
&lt;p>&lt;code>SPC g s&lt;/code> &lt;!-- raw HTML omitted -->&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>s&lt;/code>&lt;/td>
&lt;td>stage（光标对应文件上）， 或直接在文件上 &lt;code>spc g S&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>u&lt;/code>&lt;/td>
&lt;td>unstage（光标对应文件上） ，或直接在文件上 &lt;code>spc g U&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>c c&lt;/code>&lt;/td>
&lt;td>commit&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>l l&lt;/code>&lt;/td>
&lt;td>log&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>t t&lt;/code>&lt;/td>
&lt;td>tag&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>P m&lt;/code>&lt;/td>
&lt;td>push&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>P T&lt;/code>&lt;/td>
&lt;td>push tag&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>d d&lt;/code>&lt;/td>
&lt;td>diff&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>d s&lt;/code>&lt;/td>
&lt;td>diff stage&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>d u&lt;/code>&lt;/td>
&lt;td>diff unstage&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>d r&lt;/code>&lt;/td>
&lt;td>diff range&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>b c&lt;/code>&lt;/td>
&lt;td>new branch&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>b b&lt;/code>&lt;/td>
&lt;td>switch branch&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>m m&lt;/code>&lt;/td>
&lt;td>merge (如：先 b b 到 master，再 m m 选 dev 分支)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>f u&lt;/code>&lt;/td>
&lt;td>fetch&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>F u&lt;/code>&lt;/td>
&lt;td>pull&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>y r&lt;/code>&lt;/td>
&lt;td>ref&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="ranger">ranger&lt;/h2>
&lt;p>&lt;code>SPC a t r r&lt;/code> &lt;!-- raw HTML omitted -->&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>?&lt;/code>&lt;/td>
&lt;td>帮助&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>j/k&lt;/code>&lt;/td>
&lt;td>下移/上移&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>h/l&lt;/code>&lt;/td>
&lt;td>上级/下级&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>gh&lt;/code>&lt;/td>
&lt;td>HOME 目录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>f&lt;/code>&lt;/td>
&lt;td>打开文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>+&lt;/code>&lt;/td>
&lt;td>创建目录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>;C&lt;/code>&lt;/td>
&lt;td>复制&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>R&lt;/code>&lt;/td>
&lt;td>重命名/移动&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>D&lt;/code>&lt;/td>
&lt;td>删除&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>;d ;x&lt;/code>&lt;/td>
&lt;td>标记删除，然后执行&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>t&lt;/code>&lt;/td>
&lt;td>标记&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>v&lt;/code>&lt;/td>
&lt;td>反向标记&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>;U&lt;/code>&lt;/td>
&lt;td>取消标记&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>S&lt;/code>&lt;/td>
&lt;td>打开 Shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>=&lt;/code>&lt;/td>
&lt;td>比较&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-e&lt;/code>&lt;/td>
&lt;td>进入编辑模式（如多个文件重命名）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-C C-c&lt;/code>&lt;/td>
&lt;td>结束编辑模式&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-k&lt;/code>&lt;/td>
&lt;td>退出编辑模式&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>B&lt;/code>&lt;/td>
&lt;td>书签&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>m&lt;/code> _&lt;/td>
&lt;td>给目录定义快捷键&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>um&lt;/code> _&lt;/td>
&lt;td>取消快捷键&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>'&lt;/code> _&lt;/td>
&lt;td>跳转到定义快捷键的目录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>zP&lt;/code>&lt;/td>
&lt;td>切换 ranger/deer 模式&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="deft">deft&lt;/h2>
&lt;p>&lt;code>SPC a r d&lt;/code> &lt;!-- raw HTML omitted -->&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>C-c C-q&lt;/code>&lt;/td>
&lt;td>退出&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-c&lt;/code>&lt;/td>
&lt;td>清空搜索关键字&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-g&lt;/code>&lt;/td>
&lt;td>刷新搜索结果&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-l&lt;/code>&lt;/td>
&lt;td>使用 minibuffer 编辑搜索关键字，在这里可以使用 M-p 和 M-n 来遍历之前搜索过的关键字。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-t&lt;/code>&lt;/td>
&lt;td>切换搜索方式为渐进式搜索/正则搜索，默认 Deft 使用渐进搜索&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-p / C-n&lt;/code>&lt;/td>
&lt;td>定位到上一个/下一个文件处&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>RET&lt;/code>&lt;/td>
&lt;td>打开/新建文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-r&lt;/code>&lt;/td>
&lt;td>文件重命名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-d&lt;/code>&lt;/td>
&lt;td>删除文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-n&lt;/code>&lt;/td>
&lt;td>快速创建文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-c C-m&lt;/code>&lt;/td>
&lt;td>创建文件，但会提示输入文件名&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="python">python&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>spc f f&lt;/code>&lt;/td>
&lt;td>打开 py 文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>spc m c c&lt;/code>&lt;/td>
&lt;td>直接运行&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>spc m l&lt;/code>&lt;/td>
&lt;td>live mode&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>SPC m r i&lt;/code>&lt;/td>
&lt;td>清理无效 import&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>c-c c-p&lt;/code> 或 &lt;code>spc m s i&lt;/code>&lt;/td>
&lt;td>进入 ipython&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="ein">ein&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>SPC a t i r&lt;/code>&lt;/td>
&lt;td>启动 ein&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>SPC a t i o&lt;/code>&lt;/td>
&lt;td>打开 ein&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>SPC a t i s&lt;/code>&lt;/td>
&lt;td>结束 ein&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>RET&lt;/code>&lt;/td>
&lt;td>执行当前 cell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-RET&lt;/code>&lt;/td>
&lt;td>（插入模式下）执行当前 cell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>S-RET&lt;/code>&lt;/td>
&lt;td>（插入模式下）执行并新建 cell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>, .&lt;/code>&lt;/td>
&lt;td>transient&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="gist">gist&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>SPC g g l&lt;/code>&lt;/td>
&lt;td>gist 列表&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>SPC g g b&lt;/code>&lt;/td>
&lt;td>以当前 buffer 创建 gist&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>SPC g g B&lt;/code>&lt;/td>
&lt;td>以当前 buffer 创建私有 gist&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>SPC g g r&lt;/code>&lt;/td>
&lt;td>以当前区域创建 gist&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>SPC g g R&lt;/code>&lt;/td>
&lt;td>以当前区域创建私有 gist&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>b&lt;/code> 或 &lt;code>o&lt;/code>&lt;/td>
&lt;td>打开&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>+&lt;/code>&lt;/td>
&lt;td>增加&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>-&lt;/code>&lt;/td>
&lt;td>删除&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>f&lt;/code>&lt;/td>
&lt;td>抓取&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>y&lt;/code>&lt;/td>
&lt;td>复制链接&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>/&lt;/code>&lt;/td>
&lt;td>搜索&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>g r&lt;/code>&lt;/td>
&lt;td>刷新&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="easy-motion">easy-motion&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>g s s&lt;/code>&lt;/td>
&lt;td>两键定位（支持中文）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>g s spc&lt;/code>&lt;/td>
&lt;td>多键定位（本 buffer）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>g s /&lt;/code> 或 &lt;code>spc j j&lt;/code>&lt;/td>
&lt;td>多键定位（全 buffer）&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="expand-region">expand-region&lt;/h2>
&lt;p>&lt;code>SPC v&lt;/code> &lt;!-- raw HTML omitted -->&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>v&lt;/td>
&lt;td>选择更多&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>V&lt;/td>
&lt;td>选择更少&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>e&lt;/td>
&lt;td>编辑&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>r&lt;/td>
&lt;td>复位&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="imenu">imenu&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>SPC j i&lt;/code>&lt;/td>
&lt;td>跳转目录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>SPC b i&lt;/code> 或 &lt;code>SPC T i&lt;/code>&lt;/td>
&lt;td>显示目录&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="eshell">eshell&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>s&lt;/td>
&lt;td>git status&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>d&lt;/td>
&lt;td>打开目录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>e&lt;/td>
&lt;td>打开文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>z&lt;/td>
&lt;td>跳转近期目录&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="bookmark">bookmark&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>快捷键&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>C-x r m&lt;/code>&lt;/td>
&lt;td>设置书签&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-x r b&lt;/code>&lt;/td>
&lt;td>跳转书签&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>C-x r l&lt;/code>&lt;/td>
&lt;td>列出书签&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>selenium 笔记</title><link>https://winsphinx.github.io/blog/post/selenium-notes/</link><pubDate>Fri, 20 Aug 2021 18:41:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/selenium-notes/</guid><description>&lt;p>Selenium 可以根据我们的指令，让浏览器自动加载页面，获取需要的数据，实现自动化操作。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="安装">安装&lt;/h2>
&lt;h3 id="安装-selenium">安装 selenium&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">pip install selenium
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="安装驱动">安装驱动&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>浏览器&lt;/th>
&lt;th>驱动&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Firefox&lt;/td>
&lt;td>geckodriver&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Chrome&lt;/td>
&lt;td>chromedriver&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Edge&lt;/td>
&lt;td>edgedriver&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IE&lt;/td>
&lt;td>IEDriver&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Opera&lt;/td>
&lt;td>operadriver&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PhantomJS&lt;/td>
&lt;td>phantomjs&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="应用">应用&lt;/h2>
&lt;h3 id="基础">基础&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">webdriver&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 对应不同的浏览器&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">webdriver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Firefox&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># Firefox 浏览器&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">webdriver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Chrome&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># Chrome 浏览器&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">webdriver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Ie&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># Internet Explorer 浏览器&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">webdriver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Edge&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># Edge 浏览器&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">webdriver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Opera&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># Opera 浏览器&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">webdriver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PhantomJS&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># PhantomJS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 打开url网页&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取特定信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">title&lt;/span> &lt;span class="c1"># 标题&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="c1"># 浏览器名称&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">orientation&lt;/span> &lt;span class="c1"># 设备方向&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">page_source&lt;/span> &lt;span class="c1"># 源码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">current_url&lt;/span> &lt;span class="c1"># 当前 url&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">current_window_handle&lt;/span> &lt;span class="c1"># 当前窗口句柄&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">window_handles&lt;/span> &lt;span class="c1"># 所有窗口句柄&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 关闭页面&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 关闭浏览器&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">quit&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="定位">定位&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 选择元素的方法&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_id&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_class_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_tag_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_link_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_partial_link_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_xpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_css_selector&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 选择多个元素的方法，返回列表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements_by_id&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements_by_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements_by_class_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements_by_tag_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements_by_link_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements_by_partial_link_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements_by_xpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements_by_css_selector&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 另一种选择元素（组）的方法&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium.webdriver.common.by&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">By&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ID&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CLASS_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">TAG_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">LINK_TEXT&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PARTIAL_LINK_TEXT&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">XPATH&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CSS_SELECTOR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ID&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CLASS_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">TAG_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">LINK_TEXT&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PARTIAL_LINK_TEXT&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">XPATH&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_elements&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CSS_SELECTOR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 举例&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取 class=&amp;#34;nums&amp;#34; 的对象的文本&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_class_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;nums&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">text&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获取 id=&amp;#34;account&amp;#34; 的对象的属性的值&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_id&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;account&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_attribute&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;value&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 定位到 id=&amp;#34;submit&amp;#34; 的按钮并点击&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_id&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;submit&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">click&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 或者直接提交&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_id&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;submit&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">submit&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 或者也可以按回车键提交&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium.webdriver.common.keys&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_id&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;submit&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">RETURN&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 定位到 name=&amp;#34;user&amp;#34; 的输入框并填入用户名&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;user&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;zhang3&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 清空输入框内容&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;user&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">clear&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 定位到 id=&amp;#34;text&amp;#34; 的文本框并全选、剪切&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium.webdriver.common.keys&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_id&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;text&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CONTROL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_id&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;text&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CONTROL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;x&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="页面等待">页面等待&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 隐式等待，就是简单设置一个等待时间（默认为0），对整个实例有效&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">webdriver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Chrome&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">implicitly_wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 等待10秒&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_id&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">myId&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 显式等待，按一定频率（默认0.5s）不断检测一次条件，直到相应元素生成，或达到最大时限&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">webdriver&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium.webdriver.common.by&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">By&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium.webdriver.support.ui&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">WebDriverWait&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium.webdriver.support&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">expected_conditions&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">EC&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">webdriver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Chrome&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">WebDriverWait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">driver&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.5&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">until&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EC&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">presence_of_element_located&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">By&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ID&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">myId1&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 内置的判断条件，可以直接在 until/until_not 中使用&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">title_is&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">title_contains&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">visibility_of&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">visibility_of_element_located&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">invisibility_of_element_located&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">presence_of_element_located&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">presence_of_all_elements_located&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">text_to_be_present_in_element&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">text_to_be_present_in_element_value&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">frame_to_be_available_and_switch_to_it&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">element_to_be_clickable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">element_to_be_selected&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">element_located_to_be_selected&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">element_selection_state_to_be&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">element_located_selection_state_to_be&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">alert_is_present&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">staleness_of&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="控制">控制&lt;/h3>
&lt;h4 id="页面">页面&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 控制浏览器窗口大小&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">set_window_size&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">480&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">800&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">maximize_windows&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 最大化&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 浏览器页面控制&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">back&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 后退&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">forward&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 前进&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">refresh&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 刷新&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 关闭&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">quit&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 退出&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 切换框架&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">switch_to_frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;frameName&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">switch_to_default_content&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 返回父 frame&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 切换窗口&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">switch_to_window&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;windowName&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 或者&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">handle&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">window_handles&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">switch_to_window&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">handle&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 切换弹窗&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">alert&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">switch_to_alert&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">alert&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">text&lt;/span> &lt;span class="c1"># 返回 alert/confirm/prompt 中的文字信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">alert&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">accept&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 接受现有警告框&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">alert&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dismiss&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 解散现有警告框&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">alert&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 发送文本至警告框&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 选择下拉菜单&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium.webdriver.support.ui&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Select&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">select&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;status&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">select&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select_by_index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 按索引值选择&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">select&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select_by_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;0&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 按属性值选择&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">select&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select_by_visible_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">u&lt;/span>&lt;span class="s2">&amp;#34;选项三&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 按文本值选择&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">deselect&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select_by_index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 按索引值取消选择&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">deselect&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select_by_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;0&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 按属性值取消选择&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">deselect&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">select_by_visible_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">u&lt;/span>&lt;span class="s2">&amp;#34;选项三&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 按文本值取消选择&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 处理 cookie&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_cookie&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cookieName&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 获取某个 cookie&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_cookies&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 获取全部 cookies&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">delete_cookie&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cookieName&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 删除某个 cookie&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">delete_all_cookies&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 删除全部 cookies&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_cookie&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cookie_dict&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 增加 cookie 字典&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 调用 JavaScript&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">js&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;window.scrollTo(100,450);&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">execute_script&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">execute_async_script&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 页面截图&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">save_screenshot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_screenshot_as_file&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_screenshot_as_base64&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_screenshot_as_png&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="键盘">键盘&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 常用的键盘操作&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium.webdriver.common.keys&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">BACK_SPACE&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SPACE&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">TAB&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ESCAPE&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ENTER&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CONTROL&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CONTROL&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;c&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CONTROL&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;x&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CONTROL&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;v&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Keys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">F1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 上传文件可以通过发送文件路径来实现&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;file&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send_keys&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;/path/of/upload/file&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="鼠标">鼠标&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 导入 ActionChains 类&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">selenium.webdriver&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">ActionChains&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 鼠标移动到 ac 位置&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_xpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;element&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ActionChains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">driver&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">move_to_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">perform&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 在 ac 位置单击&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_xpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;elementA&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ActionChains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">driver&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">move_to_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">click&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">perform&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 在 ac 位置双击&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_xpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;elementB&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ActionChains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">driver&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">move_to_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">double_click&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">perform&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 在 ac 位置右击&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_xpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;elementC&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ActionChains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">driver&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">move_to_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">context_click&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">perform&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 在 ac 位置左键单击hold住&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_xpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;elementF&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ActionChains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">driver&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">move_to_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">click_and_hold&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">perform&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 将 ac1 拖拽到 ac2 位置&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ac1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_xpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;elementD&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ac2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">driver&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_element_by_xpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;elementE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ActionChains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">driver&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">drag_and_drop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ac1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ac2&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">perform&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 可用的有&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">click&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">click_and_hold&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">double_click&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drag_and_drop&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">key_down&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">key_up&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">move_to_element&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">perform&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">release&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_keys_to_element&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>三阶魔方步骤</title><link>https://winsphinx.github.io/blog/post/three-order-rubik-cube-steps/</link><pubDate>Sun, 18 Jul 2021 19:12:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/three-order-rubik-cube-steps/</guid><description>&lt;p>首先介绍一下本文中用到的定义：&lt;/p>
&lt;ul>
&lt;li>根据国际标准，白色的对面是黄色；&lt;/li>
&lt;li>中心块，只有一种颜色；&lt;/li>
&lt;li>棱块，两种颜色；&lt;/li>
&lt;li>角块，三种颜色；&lt;/li>
&lt;li>六个面，分别的是顶面、底面、左面、右面、正面、背面；&lt;/li>
&lt;li>横向的称为层，顶层、中层、底层；&lt;/li>
&lt;li>纵向的称为列，左列，中列、右列；&lt;/li>
&lt;li>一次右手操作：上左下右（右列上翻、顶层左转、右列下翻，顶层右转）&lt;/li>
&lt;li>一次左手操作：上右下左（左列上翻、顶层右转、左列下翻、顶部左转）&lt;/li>
&lt;/ul>
&lt;h2 id="完成顶面白色十字">完成顶面白色十字&lt;/h2>
&lt;p>目标：在顶层拼出白色十字，并且白色棱块的侧面的颜色与四个侧面的中心块相同。&lt;/p>
&lt;ol>
&lt;li>通过观察找好并拼出白色十字；&lt;/li>
&lt;li>能找到两个棱块与中心块对应的，就放在一前一左；只能找到一个对应的，就放在左面；&lt;/li>
&lt;li>执行一次右手操作，再把右列上翻；&lt;/li>
&lt;li>重复 2-3，直到顶层四个棱块与四个面的中心块全部对上。&lt;/li>
&lt;/ol>
&lt;h2 id="完成底层">完成底层&lt;/h2>
&lt;p>目标：先上下颠倒，现在白色作为底面。完成底层四个角块。&lt;/p>
&lt;ol>
&lt;li>转动颜色正确的角块到右上角；&lt;/li>
&lt;li>多次右手操作，直到角块转动到底层，并且颜色正确；&lt;/li>
&lt;li>依次完成四个底层角块。&lt;/li>
&lt;/ol>
&lt;h2 id="完成中层">完成中层&lt;/h2>
&lt;p>目标：完成中层的四个棱块。&lt;/p>
&lt;ol>
&lt;li>首先找到顶层不带黄色的棱块，将其侧面颜色与中心块相符；&lt;/li>
&lt;li>再观察顶面的颜色，如果在左面则顶层右转，如果在右面则顶层左转，即向着符合的颜色的反方向旋转；&lt;/li>
&lt;li>如果上述符合的面是左面，则执行一次左手操作；如果上述符合的面是右面，则执行一次右手操作；&lt;/li>
&lt;li>现在白色出现在正面左上，把整个魔方右转，使得白色在右面前上，执行一次右手操作；如果白色出现在正面右上，把整个魔方左，使得白色在左面前上，执行一次左手操作；&lt;/li>
&lt;li>如果顶层没有符合的棱块，（即顶层棱块都带有黄色，而不带黄色的棱块处在中层，只是颜色、方向不匹配），这种情况下，先将此魔方转到使得此棱块在右列，执行一次右手操作，观察白色角块位置，执行第 4 步；&lt;/li>
&lt;li>此时再回到第一步继续处理，直到中层全部棱块位置、颜色全部正确。&lt;/li>
&lt;/ol>
&lt;h2 id="完成顶面黄色十字">完成顶面黄色十字&lt;/h2>
&lt;p>目标：在顶面完成黄色十字。&lt;/p>
&lt;ol>
&lt;li>如果顶面是三个黄色组成横条，则将其横置，然后前面顺时针一次，右手操作一次，前面逆时针转回；&lt;/li>
&lt;li>如果顶面是三个黄色组成拐角，则将其位于右下角，即三个色块一中一前一右，然后前面顺时针一次，右手操作一次，前面逆时针转回；然后再次回到第 1 步；&lt;/li>
&lt;li>如果不是上述两种情况，也是前面顺时针转一次，右手操作一次，前面逆时针转回。直到出现上述两种情况后继续处理。&lt;/li>
&lt;/ol>
&lt;h2 id="完成顶层棱块">完成顶层棱块&lt;/h2>
&lt;p>目标：使得顶层棱块侧面颜色正确。&lt;/p>
&lt;ol>
&lt;li>观察并调整顶层棱块侧面颜色，使其与侧面中心块尽可能相符：如果是相邻两面相同，则放在一左一后；如果是相对两面相同，则放在一前一后；&lt;/li>
&lt;li>依次执行：前面顺转一次、两次右手公式、前面顺转两次、左手公式，前面顺转一次；&lt;/li>
&lt;li>观察并调整顶层，使得四面颜色全部正确。&lt;/li>
&lt;/ol>
&lt;h2 id="完成顶层角块位置">完成顶层角块位置&lt;/h2>
&lt;p>目标：找对顶层四个角块位置，即三个面的颜色对应所在位置，颜色的方向暂时不做调整。&lt;/p>
&lt;ol>
&lt;li>找到一个位置对的角块，把角块放在右上角，然后依次执行：三次右手公式、左面上翻一次、三次右手公式、左面下翻一次；&lt;/li>
&lt;li>如果四个角块位置都不对，也按上面的步骤做完以后就会出现一个位置正确的角块，然后再重复一次；&lt;/li>
&lt;li>直到四个角块位置正确。&lt;/li>
&lt;/ol>
&lt;h2 id="完成顶层角块颜色">完成顶层角块颜色&lt;/h2>
&lt;p>目标：全部完成。&lt;/p>
&lt;ol>
&lt;li>反转魔法使得黄色面在左侧；&lt;/li>
&lt;li>观察左列黄色角块，如果在顶层左上方，则执行四次右手操作；如果在顶层左后方则执行两次右手操作；&lt;/li>
&lt;li>直到黄色全部出现在左面，转动左列，直到六个面全部完成。&lt;/li>
&lt;/ol></description></item><item><title>自然语言与机器语言的语序对比</title><link>https://winsphinx.github.io/blog/post/word-order/</link><pubDate>Sun, 27 Jun 2021 19:56:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/word-order/</guid><description>&lt;p>本文简单探讨一下碳基生物与硅基生物的语言的语序。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="概念">概念&lt;/h2>
&lt;p>语言的主干分主语（subject）、谓词（verb）、宾语（object），其顺序根据排列组合，有 SOV（43.3%，所占语言比例，下同）、SVO（40.3%）、VSO（9.5%）、VOS（3.3%）、OVS（0.7%）、OSV（0.3%）、不固定（2.3%）七种&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>。世界上大部分语言都属于前三种。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>而在计算机的数据结构与算法里，表达式也分前缀表达式、中缀表达式、后缀表达式。但是奇怪的是，即使对于不是 SVO 的母语者而言，其数学也普遍采用中缀表达式。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="对比">对比&lt;/h2>
&lt;h3 id="中缀表达式">中缀表达式&lt;/h3>
&lt;p>这个大概是最常见的，即： &lt;code>操作数 操作符 操作数&lt;/code>​，比如简单的： &lt;code>3 + 4&lt;/code>​，复杂的： &lt;code>(1 + (3 * 4) / 6 ) - 5&lt;/code>​，需要用括号调整运算优先级。 &lt;!-- raw HTML omitted -->
自然语言中的汉语（乌鸦喝水。）、英语也是这个结构。 &lt;!-- raw HTML omitted -->
对于大多数面向对象的语言，谓词可以认为是某个对象的一个方法（method），宾语则是其参数。如 Java： &lt;code>Raven.drink(Water)&lt;/code>​。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h3 id="前缀表达式">前缀表达式&lt;/h3>
&lt;p>也叫波兰表示法，其特点是操作符置于操作数的前面，即： &lt;code>操作符 操作数 操作数&lt;/code>​。比如简单的： &lt;code>+ 3 4&lt;/code>​，复杂的： &lt;code>- + 1 / * 3 4 6 5&lt;/code>​。 &lt;!-- raw HTML omitted -->
自然语言中的阿拉伯语（يشرب غراب الماء）、希伯来语也是这个结构。 &lt;!-- raw HTML omitted -->
有些语言采用的也是前缀表达，如 lisp： &lt;code>(drink Raven Water)&lt;/code>​。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h3 id="后缀表达式">后缀表达式&lt;/h3>
&lt;p>也叫逆波兰表示法，所有操作符置于操作数的后面，即： &lt;code>操作数 操作数 操作符&lt;/code>​。比如简单的： &lt;code>3 4 +&lt;/code>​，复杂的： &lt;code>1 3 4 * 6 / + 5 -&lt;/code>​。 &lt;!-- raw HTML omitted -->
自然语言中的日语（カラスは水を飲む。）、韩语也是这个结构。 &lt;!-- raw HTML omitted -->
也要语言采用后缀表达，如 forth： &lt;code>: Raven Water drink;&lt;/code>​。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Word_order">https://en.wikipedia.org/wiki/Word_order&lt;/a> &lt;!-- raw HTML omitted -->&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>读尤·奈斯博系列</title><link>https://winsphinx.github.io/blog/post/reading-jo-nesbo-series/</link><pubDate>Sun, 23 May 2021 19:46:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/reading-jo-nesbo-series/</guid><description>&lt;p>尤·奈斯博（Jo Nesbø），挪威作家。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;h2 id="哈利警探">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 哈利警探 &lt;!-- raw HTML omitted -->[11/12]&lt;!-- raw HTML omitted -->&lt;/h2>
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Flaggermusmannen (The Bat)《蝙蝠》- 1997 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Kakerlakkene (Cockroaches)《蟑螂》- 1998 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Rødstrupe (The Redbreast)《知更鸟》又译《孤独的精确度》- 2000 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Sorgenfri (Nemesis)《复仇者》又译《悲伤的精确度》- 2002 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Marekors (The Devil&amp;rsquo;s Star)《恶魔星》又译《死亡的精确度》- 2003 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Frelseren (The Redeemer)《救赎者》- 2005 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Snømannen (The Snowman)《雪人》- 2006 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Panserhjerte (The Leopard)《猎豹》- 2009 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Gjenferd (Phantom)《幽灵》- 2011 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Politi (Police)《警察》- 2013 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Tørst（The Thirst）《焦渴》- 2017 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Kniv（Knife）《》- 2019 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;h2 id="其他系列">&lt;!-- raw HTML omitted -->TODO&lt;!-- raw HTML omitted --> 其他系列 &lt;!-- raw HTML omitted -->[0/4]&lt;!-- raw HTML omitted -->&lt;/h2>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> Hodejegerne（Headhunters）《》-2008 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Sønnen（The Son）《》- 2014 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Blod på snø（Blood on Snow）《》- 2015 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Mere blod（Midnight Sun）《》- 2015 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul></description></item><item><title>Automatically Creating PDF from LaTeX with Github Actions</title><link>https://winsphinx.github.io/blog/post/automatically-creating-pdf-from-latex-with-github-actions/</link><pubDate>Mon, 12 Apr 2021 18:02:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/automatically-creating-pdf-from-latex-with-github-actions/</guid><description>&lt;p>自从体验了 Github Actions，感觉非常好用。之前介绍过使用 Appveyor 来生成 PDF&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>，现在介绍下使用 Github Actions 来生成 PDF，并发布到 release 的步骤。&lt;/p>
&lt;p>例子如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Build LaTeX&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">push&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">branches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">master ]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">pull_request&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">branches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">master ]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">build&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">runs-on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-latest &lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># 目前只能在linux下&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Set up Git repository&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/checkout@v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Build LaTeX&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">xu-cheng/latex-action@v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">root_file&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">fei.tex&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">latexmk_use_xelatex&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># 为了支持中文，使用xelatex&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Create GitHub release&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">marvinpinto/action-automatic-releases@latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">repo_token&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;${{ secrets.GITHUB_TOKEN }}&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">automatic_release_tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">prerelease&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">files&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">filename.pdf &lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># 生成的 pdf，发布到 release&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;a href="https://winsphinx.github.io/blog/post/automatically-creating-pdf-from-latex-with-appveyor/">Automatically Creating PDF from LaTeX with Appveyor&lt;/a>&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Using pmdaria to Forecast COVID-19</title><link>https://winsphinx.github.io/blog/post/using-pmdaria-to-forecast-covid-19/</link><pubDate>Tue, 06 Apr 2021 19:38:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/using-pmdaria-to-forecast-covid-19/</guid><description>&lt;p>之前写过两篇&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>预测 COVID-19 的方法，这次用个“偷懒”的办法，直接采用 pmdaria 来自动调整参数，用来预测分析。&lt;/p>
&lt;p>这次的特色是，利用 Github Actions 来定时自动运行脚本，达到&lt;a href="https://github.com/winsphinx/covid">每日更新&lt;/a>的目的。&lt;/p>
&lt;h2 id="首先是-python-脚本">首先是 Python 脚本&lt;/h2>
&lt;p>Python 脚本总体思路是，从网上获取数据，再利用 pmdarima 自动选择参数并作出预测，最后利用 matplotlib 生成预测的图像。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/env python&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -*- coding: utf-8 -*-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">codecs&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">re&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">concurrent.futures&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">ProcessPoolExecutor&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">matplotlib.pyplot&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="nn">plt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">pandas&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="nn">pd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">pmdarima&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">arima&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">pmdarima.model_selection&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">train_test_split&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">sklearn.metrics&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">r2_score&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">adjust_date&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">t&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;20&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">-&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">02d&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">-&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">02d&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">adjust_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">re&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sub&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">r&lt;/span>&lt;span class="s2">&amp;#34;\*|\,|\(|\)|\*|\ |\&amp;#39;&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;_&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">draw&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">draw_&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">draw_&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">draw_&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">isDaily&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 模型训练&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">model&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arima&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">AutoARIMA&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">start_p&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">max_p&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">d&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">start_q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">max_q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">start_P&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">max_P&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">D&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">start_Q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">max_Q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">m&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">seasonal&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">test&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;kpss&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">trace&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error_action&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;ignore&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">suppress_warnings&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">stepwise&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">isDaily&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">diff&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dropna&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">model&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">model&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 模型验证&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">train&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">train_test_split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">train_size&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.8&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pred_test&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">predict_in_sample&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">train&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">shape&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">dynamic&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">validating&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Series&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pred_test&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">index&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">r2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">r2_score&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pred_test&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 开始预测&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pred&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pred_ci&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">predict&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">n_periods&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">14&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">return_conf_int&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">idx&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">date_range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">max&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">pd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Timedelta&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;1D&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">periods&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">14&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">freq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;D&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">forecasting&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Series&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pred&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">index&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">idx&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 绘图呈现&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">figure&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">figsize&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">15&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">plot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">label&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Actual Value&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;blue&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">plot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">validating&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">validating&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">label&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Check Value&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;orange&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">plot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">forecasting&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">forecasting&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">label&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Predict Value&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;red&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># plt.fill_between(forecasting.index, pred_ci[:, 0], pred_ci[:, 1], color=&amp;#34;black&amp;#34;, alpha=.25)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">legend&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ticklabel_format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;plain&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">axis&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;y&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># plt.rcParams[&amp;#34;font.sans-serif&amp;#34;] = [&amp;#34;Microsoft YaHei&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">isDaily&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">title&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;Daily Confirmed Cases Forecasting - &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">ARIMA &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">model_&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">order&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">x&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">model_&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">seasonal_order&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> (R2 = &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">r2&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.6f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">savefig&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;figures&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;covid-&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">adjust_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">-daily.svg&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bbox_inches&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;tight&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">title&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;Accumulative Confirmed Cases Forecasting - &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">ARIMA &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">model_&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">order&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">x&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">model_&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">seasonal_order&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> (R2 = &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">r2&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.6f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">savefig&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;figures&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;covid-&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">adjust_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.svg&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bbox_inches&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;tight&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 准备数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">df&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read_csv&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">.&lt;/span>&lt;span class="n">drop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">columns&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;Lat&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;Long&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">.&lt;/span>&lt;span class="n">groupby&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Country/Region&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">.&lt;/span>&lt;span class="n">sum&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">.&lt;/span>&lt;span class="n">transpose&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">DatetimeIndex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">adjust_date&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">countries&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">columns&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_list&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 线程池&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">with&lt;/span> &lt;span class="n">ProcessPoolExecutor&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">pool&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pool&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">draw&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">countries&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pool&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">shutdown&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">wait&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 编制索引&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">with&lt;/span> &lt;span class="n">codecs&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;README.md&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;w&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;utf-8&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;[![check status](https://github.com/winsphinx/covid/actions/workflows/check.yml/badge.svg)](https://github.com/winsphinx/covid/actions/workflows/check.yml)&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;[![build status](https://github.com/winsphinx/covid/actions/workflows/build.yml/badge.svg)](https://github.com/winsphinx/covid/actions/workflows/build.yml)&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;# COVID-19 Forecasting&lt;/span>&lt;span class="se">\n\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">country&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">countries&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;## &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="se">\n\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;![img](figures/covid-&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">adjust_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.svg)&lt;/span>&lt;span class="se">\n\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;![img](figures/covid-&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">adjust_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">country&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">-daily.svg)&lt;/span>&lt;span class="se">\n\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="然后是-github-actions-脚本">然后是 Github Actions 脚本&lt;/h2>
&lt;p>Github Actions 可以根据预先设定的各种条件来触发，如定时触发、push、pull requset 时触发、手动触发等。&lt;/p>
&lt;p>然后可以按顺序定义一系列的操作步骤，如本脚本的步骤就是先是拉取（pull）仓库，再是运行 Python 脚本生成数据，然后再递交（commit）、推送（push）回去。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">build status&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">workflow_dispatch&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># 加入这个触发器，可以用来按需手工运行&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">schedule&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">cron&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;30 */12 * * *&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># 按计划在每天0:30、12:30运行&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">build&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">runs-on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">windows-latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Set up Git repository&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/checkout@v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">persist-credentials&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># otherwise, the token used is the GITHUB_TOKEN, instead of your personal token&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">fetch-depth&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># otherwise, you will failed to push refs to dest repo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Set up Python&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/setup-python@v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Create local files&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> python -m pip install --upgrade pip
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> pip install -U matplotlib pandas pmdarima scikit_learn
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> python covid.py&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Commit files&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> git config --local user.email &amp;#34;github-actions[bot]@users.noreply.github.com&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> git config --local user.name &amp;#34;github-actions[bot]&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> git add .
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> git commit -m &amp;#34;Auto Update&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Push changes&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ad-m/github-push-action@master&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">github_token&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ secrets.GITHUB_TOKEN }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">branch&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ github.ref }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;a href="https://winsphinx.github.io/blog/post/using-arima-to-forecast-covid-19/">Using ARIMA to Forecast COVID-19&lt;/a>&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>&lt;a href="https://winsphinx.github.io/blog/post/using-scikit-learn-to-forecast-covid-19/">Using scikit-learn to Forecast COVID-19&lt;/a>&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>aria2</title><link>https://winsphinx.github.io/blog/post/aria2/</link><pubDate>Wed, 17 Mar 2021 20:16:00 +0800</pubDate><guid>https://winsphinx.github.io/blog/post/aria2/</guid><description>&lt;blockquote>
&lt;p>aria2 是一个自由、开源、轻量级多协议和多源的命令行下载工具。它支持 HTTP/HTTPS、FTP、SFTP、 BitTorrent 和 Metalink 协议。aria2 可以通过内建的 JSON-RPC 和 XML-RPC 接口来操纵。 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;h2 id="aria2-特性">aria2 特性&lt;/h2>
&lt;ul>
&lt;li>支持 HTTP/HTTPS GET &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>支持 HTTP 代理 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>支持 HTTP BASIC 认证 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>支持 HTTP 代理认证 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>支持 FTP （主动、被动模式） &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>通过 HTTP 代理的 FTP（GET 命令行或者隧道） &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>分段下载 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>支持 Cookie &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>可以作为守护进程运行。 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>支持使用 fast 扩展的 BitTorrent 协议 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>支持在多文件 torrent 中选择文件 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>支持 Metalink 3.0 版本（HTTP/FTP/BitTorrent） &lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>限制下载、上传速度 &lt;!-- raw HTML omitted -->&lt;/li>
&lt;/ul>
&lt;h2 id="aria2-使用">aria2 使用&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>下载单个文件 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c LINK
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>下载多个文件 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c -Z LINK1 LINK2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> aria2c -Z -P LINK&lt;span class="o">{&lt;/span>1,2&lt;span class="o">}&lt;/span> &lt;span class="c1"># 用 -P扩展&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>下载更名 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c LINK -o NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>限速下载 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c --max-download-limit&lt;span class="o">=&lt;/span>500k LINK
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>续传 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c -c LINK
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>按列表文件下载 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c -i LISTFILE
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>多连接下载 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c -xN LINK
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>多线程下载 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c -sN LINK
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>下载 BitTorrent 种子文件、磁力链接 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c filename.torrent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> aria2c &lt;span class="s1">&amp;#39;magnet:metalink&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>下载 BitTorrent 种子文件、磁力链接中的某个/某些文件 &lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> aria2c -S filename.torrent &lt;span class="c1"># 先获取文件列表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> aria2c --select-file&lt;span class="o">=&lt;/span>1-3,6 filename.torrent &lt;span class="c1"># 下载其中编号为1，2，3，6的文件&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul></description></item></channel></rss>